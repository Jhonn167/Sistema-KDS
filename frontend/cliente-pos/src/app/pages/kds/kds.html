<!-- src/app/pages/kds/kds.component.html -->

<div class="kds-container">
  <h1>KDS - Pedidos para Cocina</h1>
  <div *ngIf="isLoading" class="info-message">Cargando pedidos...</div>
  <div *ngIf="!isLoading && pedidos.length === 0" class="info-message">No hay pedidos pendientes.</div>
  
  <div class="pedidos-grid">
   <!-- src/app/pages/kds/kds.component.html -->
<div *ngFor="let pedido of pedidos" class="pedido-card">
  <div class="card-header">
    <h3>Pedido #{{ pedido.id_pedido }} - {{ pedido.nombre_cliente }}</h3>
    <div class="header-details">
      <!-- CORREGIDO: Usa fecha_recogida y pipe 'date' -->
      <div *ngIf="pedido.fecha_recogida; else creationTime" class="pickup-time">
        <span>Recoger:</span>
        <strong>{{ pedido.fecha_recogida | date:'short' }}</strong>
      </div>
      <ng-template #creationTime>
        <div class="creation-time">
          <span>Pedido a las: {{ pedido.fecha | date:'mediumTime' }}</span>
        </div>
      </ng-template>
        <!-- ===================================== -->

      </div>
      <div class="card-body">
        <ul>
          <li *ngFor="let item of pedido.items">
            <div class="item-main">
              <span class="cantidad">{{ item.cantidad }}x</span>
              <span class="nombre">{{ item.producto }}</span>
            </div>
            <ul *ngIf="item.opciones && item.opciones.length > 0" class="options-sublist">
              <li *ngFor="let option of item.opciones">+ {{ option.nombre }}</li>
            </ul>
          </li>
        </ul>
      </div>
      <div class="card-footer">
        <button (click)="actualizarEstatus(pedido.id_pedido, 'Listo para Recoger')">
          Marcar como Listo
        </button>
      </div>
    </div>
  </div>
</div>

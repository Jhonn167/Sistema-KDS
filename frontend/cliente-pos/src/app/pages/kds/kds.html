<div class="kds-container">
  <div class="kds-header">
    <h1>KDS - Pedidos para Cocina</h1>
  </div>
  
  <div *ngIf="isLoading" class="info-message">Cargando pedidos...</div>
  <div *ngIf="!isLoading && pedidos.length === 0" class="info-message">No hay pedidos pendientes.</div>
  
  <div class="pedidos-grid">
    <div *ngFor="let pedido of pedidos" class="pedido-card" [ngClass]="pedido.estatus.toLowerCase().replace(' ', '-')">
      <div class="card-header">
        <div class="pedido-info">
          <h3>#{{ pedido.id_pedido }} - {{ pedido.nombre_cliente }}</h3>
          <span class="pedido-status">{{ pedido.estatus }}</span>
        </div>
        <div class="time-info">
      <!-- Muestra fecha y hora para pedidos programados -->
      <div *ngIf="pedido.estatus === 'Programado' && pedido.hora_recogida" class="pickup-time">
        <span>Para el</span>
        <strong>{{ pedido.hora_recogida | date:'short' }}</strong>
      </div>
      <!-- Muestra tiempo transcurrido para los dem치s -->
      <div *ngIf="pedido.estatus !== 'Programado'" class="time-elapsed">
        <span>Hace</span>
        <strong>{{ pedido.tiempo_transcurrido }}</strong>
          </div>
        </div>
      </div>
      <div class="card-body">
        <ul>
          <li *ngFor="let item of pedido.items">
            <div class="item-main">
              <span class="cantidad">{{ item.cantidad }}x</span>
              <span class="nombre">{{ item.producto }}</span>
            </div>
            <ul *ngIf="item.opciones && item.opciones.length > 0" class="options-sublist">
              <li *ngFor="let option of item.opciones">+ {{ option.nombre }}</li>
            </ul>
          </li>
        </ul>
      </div>
      <div class="card-footer">
        <button *ngIf="pedido.estatus === 'Pendiente' || pedido.estatus === 'Programado'" 
                class="btn btn-start" 
                (click)="actualizarEstatus(pedido.id_pedido, 'En Preparaci칩n')">
          Empezar Preparaci칩n
        </button>
        <button *ngIf="pedido.estatus === 'En Preparaci칩n'" 
                class="btn btn-ready" 
                (click)="actualizarEstatus(pedido.id_pedido, 'Listo para Recoger')">
          Marcar como Listo
        </button>
      </div>
    </div>
  </div>
</div>
